<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/node_modules/normalize.css/normalize.css">
    <title>THE PTOOLS - this is not a cheat bro</title>
  </head>
  <body>
    <div id="container">
      <div id="main"></div>
      <div id="q">
        <div id="r"><p><button>The PTOOLS</button> by Minhyeok Park &copy;</p><textarea placeholder="Yea 'Reinventing the wheel' but Improved.&#10;&#10;(take a note here)"></textarea></div>
        <div id="r"><p>regexp</p><textarea id="regexp"></textarea></div>
        <div id="r"><p>base64d</p><textarea id="base64d"></textarea></div>
        <div id="r"><p>base64e</p><textarea id="base64e"></textarea></div>
        <div id="r"><p>urid</p><textarea id="urid"></textarea></div>
        <div id="r"><p>urie</p><textarea id="urie"></textarea></div>
        <div id="r"><p>jsonbtf</p><textarea id="jsonbtf"></textarea></div>
        <div id="r"><p>jsonsmp</p><textarea id="jsonsmp"></textarea></div>
        <div id="r"><p>json2yml</p><textarea id="json2yml"></textarea></div>
        <div id="r"><p>yml2json</p><textarea id="yml2json"></textarea></div>
      </div>
    </div>

    <style>
      :root {
        background-color: #212121;
      }

      * {
        margin: 0;
        padding: 0;
      }

      html, body, #container {
        width: 100%;
        height: 100%;
        user-select: none;
      }
      
      #container {
        display: flex;
        color: #fafafa;
        background-color: #212121;
        font-family: Arial, Helvetica, sans-serif;
      }

      #container > * {
        flex: 1;
      }

      #main {
        background-color: #1e1e1e;
      }

      #q {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        padding: 10px;
        max-height: 100%;
        overflow-x: scroll;
      }

      #q > * {
        flex: 1;
      }

      #r {
        display: flex;
        min-height: 200px;
        flex-direction: column;
        background-color: #1e1e1e;
        border-radius: 4px;
        padding: 10px;
      }

      #r > textarea {
        flex: 1;
        border: none;
        resize: none;
        background-color: transparent;
        color: #fafafa;
        padding: 10px;
      }

      #r > textarea:focus {
        outline: none;
      }

      #r > p {
        padding: 10px;
        background-color: #323232;
        border-radius: 4px;
      }

      #r button {
        border: none;
        padding: 6px 10px;
        border-radius: 4px;
        cursor: pointer;
        background-color: #ff1696;
        color: white;
        margin-right: 6px;
      }

      #r button:hover {
        background-color: #da1c9b;
      }
    </style>

		<script src="/node_modules/monaco-editor/min/vs/loader.js"></script>
		<script type="module">
      import JSON5 from '/node_modules/json5/dist/index.min.mjs'
      import YAML from '/node_modules/yaml/browser/index.js'

			require.config({ paths: { vs: '/node_modules/monaco-editor/min/vs' } });

			require(['vs/editor/editor.main'], function () {
				var editor = monaco.editor.create(document.getElementById('main'), {
					value: 'Type Something Here',
					language: 'yaml',
          automaticLayout: true,
          minimap: { enabled: false },
          fontSize: 16,
          theme: "vs-dark",
          scrollBeyondLastLine: false,
          fontFamily: 'Arial',
          fontLigatures: true,
          wordWrap: true
				});


        render()
        function render () {
          const value = editor.getValue()
          setTimeout(() => {
            try { document.getElementById('regexp').value = value.split('\r\n\r\n').slice(0, 2).join('\n\n') + '\n\n' + ((value.split('\r\n\r\n')[1] || '').split('\r\n').map(v => JSON.stringify(new RegExp(value.split('\r\n\r\n')[0]).exec(v)?.groups)).join('\n')) } catch (err) { document.getElementById('regexp').value = err ?? '(err)' }
            try { document.getElementById('base64d').value = atob(value) } catch (err) { document.getElementById('base64d').value = err ?? '(err)' }
            try { document.getElementById('base64e').value = btoa(value) } catch (err) { document.getElementById('base64e').value = err ?? '(err)' }
            try { document.getElementById('urid').value = document.getElementById('uridcmp').checked ? decodeURIComponent(value) : decodeURI(value) } catch (err) { document.getElementById('urid').value = err ?? '(err)' }
            try { document.getElementById('urie').value = document.getElementById('uriecmp').checked ? encodeURIComponent(value) : encodeURI(value) } catch (err) { document.getElementById('urie').value = err ?? '(err)' }
            try { document.getElementById('jsonbtf').value = value.split('\n').map((v) => JSON.stringify(JSON5.parse(v), null, parseInt(document.getElementById('jsonbtfsp').value))).join('\n') } catch (err) { document.getElementById('jsonbtf').value = err ?? '(err)' }
            try { document.getElementById('jsonsmp').value = JSON.stringify(JSON5.parse(value)) } catch (err) { document.getElementById('jsonsmp').value = err ?? '(err)' }
            try { document.getElementById('json2yml').value = YAML.stringify(JSON5.parse(value)) } catch (err) { document.getElementById('json2yml').value = err ?? '(err)' }
            try { document.getElementById('yml2json').value = JSON.stringify(YAML.parse(value)) } catch (err) { document.getElementById('yml2json').value = err ?? '(err)' }
          }, 1000)
        }

        editor.getModel().onDidChangeContent((event) => {
          render()
        });
			});
		</script>
  </body>
</html>
